# to install tmux plugins, run the following command in tmux:
# `prefix + I`

source-file ~/.config/tmux/tmux.reset.conf             # Load keybinding overrides and window operations from reset file
set-option -g default-terminal 'tmux-256color'         # Set terminal type for 256 color support
set-option -g terminal-overrides ',*:RGB'              # Enable true color support for all terminals

# set-option -g default-shell "/usr/local/bin/bash"
set-option -g default-shell /bin/zsh                # Use zsh for tmux panes

# DELETE: 
# bind-key -r v run-shell "tmux neww ~/.config/tmux/scripts/tmux-sessionizer"

# DELETE: ??
set -g prefix ^A                                        # Set prefix key to Ctrl+A

# DELETE: ??
set -g prefix ^S                                        # Also set prefix key to Ctrl+S (dual prefix)

# DELETE: ??
unbind C-b                                              # Remove default Ctrl+b prefix
unbind C-a                                              # Remove any Ctrl+a binding
unbind C-s                                              # Remove any Ctrl+s binding

set-option -g prefix C-Space                            # Set prefix to Ctrl+spacebar
bind-key C-Space send-prefix                            # Send prefix key to application when pressed twice

set -g base-index 1                                     # Start indexing windows at 1 instead of 0
set -g detach-on-destroy off                            # Don't exit from tmux when closing a session
set -g escape-time 0                                    # Zero-out escape time delay
set -g display-time 750                                 # Show messages for 750ms (default, was 4000ms)
# set -g display-panes-time 300                           # Show pane indicators for 800ms 

# remove delay for exiting insert mode with ESC in Neovim # it's fast enough to
# feel instant while avoiding potential terminal sequence conflicts.
# set -sg escape-time 10                               # Alternative escape time setting (commented)

set -g history-limit 1000000                           
set -g renumber-windows on                              # Renumber all windows when any window is closed
set -g set-clipboard on                                 # Use system clipboard
set -g status-position top                              # macOS / darwin style - status bar at top
setw -g mode-keys vi                                    # Use vi-style key bindings in copy mode

set -g mouse on                                         # Enable mouse support

set -g automatic-rename off                          # Disable automatic window renaming (stop the rename whenever you cd)
set-window-option -g allow-rename off               # Disable window renaming (stop the rename whenever you cd)

# Set terminal title to show tmux session name
set -g set-titles on                                # Enable setting terminal title
set -g set-titles-string "#S"                       # Set title to session name

set -g @plugin 'christoomey/vim-tmux-navigator'        # Plugin for seamless vim/tmux pane navigation
# set -g @tmux_navigator_disable_when_zoomed 1          # " Disable tmux navigator when zooming the Vim pane
# set -g @tmux_navigator_save_on_switch 2              # " Write all buffers before navigating from Vim to tmux pane

set -g @fzf-url-fzf-options '-p 60%,30% --prompt="   " --border-label=" Open URL "'  # FZF URL options
set -g @fzf-url-history-limit '2000'                   # FZF URL history limit
set -g @fzf-url-bind 'o'                                 # Use `o` to open URLs


set -g @plugin 'tmux-plugins/tpm'                      # Tmux Plugin Manager
set -g @plugin 'tmux-plugins/tmux-sensible'            # Basic tmux settings everyone can agree on
set -g @plugin 'tmux-plugins/tmux-yank'                # Copy to system clipboard
set -g @plugin 'tmux-plugins/tmux-resurrect'           # Restore tmux environment after restart
set -g @plugin 'tmux-plugins/tmux-continuum'           # Continuous saving of tmux environment
# set -g @plugin 'fcsonline/tmux-thumbs'                 # Copy/paste with vimium/vimperator like hints
set -g @plugin 'sainnhe/tmux-fzf'                      # Use fzf to manage tmux work environment
set -g @plugin 'wfxr/tmux-fzf-url'                     # Quickly open any url on terminal window
set -g @plugin 'omerxx/catppuccin-tmux'                # Fork with meetings script (Catppuccin theme)
set -g @plugin 'omerxx/tmux-sessionx'                  # Fuzzy session manager
set -g @plugin 'omerxx/tmux-floax'                     # Floating terminal window

# TODO: remap binding for thumbs. right now its prefix spacebar
# thumbs to Prefix+Tab (freeing up Space for layout cycling) 
 # set -g @thumbs-key 'Tab'

# TODO: Is there a way to define another binding so that I can have a fresh terminal pop-up that clears every single time?
set -g @floax-width '60%'                              # Floating window width
set -g @floax-height '80%'                             # Floating window height
set -g @floax-border-color 'magenta'                   # Floating window border color
set -g @floax-text-color 'blue'                        # Floating window text color
set -g @floax-bind 'p'                                 # Key binding for floating window (Prefix+p)
set -g @floax-change-path 'false'                      # Change directory when opening floating window
# When the pane is toggled, using this bind pops a menu with additional options
# such as resize, fullscreen, resetting to defaults and more.
set -g @floax-bind-menu 'P'
# The default session name of the floating pane is 'scratch'
# You can modify the session name with this option:
# set -g @floax-session-name 'some-other-floax-session-name'
# Change the title of the floating window
set -g @floax-title 'floax-floating-window-title'
set -g @floax-session-name 'floax-floating-window'
# TODO: floax: position to the left. or at least make it persist its location

# set -g @floax-x-position 'L'        # Position horizontally: L (left), C (center), R (right)
# set -g @floax-y-position 'C'        # Position vertically: T (top), C (center), B (bottom)

set -g @sessionx-bind-zo-new-window 'ctrl-y'           # SessionX: binding for zoom to new window
# set -g @sessionx-auto-accept 'off'                     # SessionX: disable auto-accept
set -g @sessionx-custom-paths '$HOME/.config/scripts,$HOME/scripts,$HOME/Projects,$HOME/code,$HOME/code/experiments,$HOME/code/aitools'
# set -g @sessionx-x-path '~/Projects/'                  # SessionX: Can access with control-x
# TODO: trigger sessionx with f
set -g @sessionx-bind 'f'                              # SessionX: trigger sessionx
set -g @sessionx-window-height '95%'                   # SessionX: popup window height
set -g @sessionx-window-width '85%'                    # SessionX: popup window width
set -g @sessionx-zoxide-mode 'on'                      # SessionX: enable zoxide integration
set -g @sessionx-custom-paths-subdirectories 'true'   # Sessionx: shows subdirectories of custom paths
set -g @sessionx-filter-current 'false'                # SessionX: false = show current session in list, true = hide it
# set -g @sessionx-ls-command 'lsd --tree --color=always --icon=always --timesort'

# DELETE: 
set -g @sessionx-bind-select-up 'ctrl-p'        #  move selection up
set -g @sessionx-bind-select-down 'ctrl-n'      #  move selection

set -g @continuum-restore 'on'                         # Continuum: automatically restore sessions
set -g @continuum-save-interval '15'                  # Continuum: save every 15 minutes instead of constantly

set -g @resurrect-strategy-nvim 'session'              # Resurrect: restore nvim sessions

set -g @catppuccin_window_left_separator ""            # Catppuccin: window left separator
set -g @catppuccin_window_right_separator " "          # Catppuccin: window right separator
set -g @catppuccin_window_middle_separator " â–ˆ"        # Catppuccin: window middle separator
set -g @catppuccin_window_number_position "right"      # Catppuccin: window number position
set -g @catppuccin_window_default_fill "number"        # Catppuccin: default window fill style
set -g @catppuccin_window_default_text "#W"            # Catppuccin: default window text
set -g @catppuccin_window_current_fill "number"        # Catppuccin: current window fill style
set -g @catppuccin_window_current_text "#W#{?window_zoomed_flag,(),}"  # Catppuccin: current window text (shows () when window is zoomed)
set -g @catppuccin_status_modules_right "directory date_time"  # Catppuccin: right status modules
set -g @catppuccin_status_modules_left "session"       # Catppuccin: left status modules


set -g @catppuccin_status_left_separator  " "          # Catppuccin: left status separator
set -g @catppuccin_status_right_separator " "          # Catppuccin: right status separator
set -g @catppuccin_status_right_separator_inverse "no" # Catppuccin: disable right separator inverse
set -g @catppuccin_status_fill "icon"                  # Catppuccin: status fill style
set -g @catppuccin_status_connect_separator "no"       # Catppuccin: disable status connect separator
set -g @catppuccin_directory_text "#{b:pane_current_path}"  # Catppuccin: show basename of current path
# set -g @catppuccin_meetings_text "#($HOME/.config/tmux/scripts/cal.sh)"  # Catppuccin: custom meetings script
set -g @catppuccin_date_time_text "%H:%M"              # Catppuccin: time format (hours:minutes)

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.config/tmux/plugins/tpm/tpm'                   # Load and run tmux plugin manager

# Override Catppuccin pane border settings (must come AFTER plugin loading)
set -g pane-active-border-style 'fg=#ff0000,bg=#ff0000'  # Active pane border (bright red with background)
# set -g pane-border-style 'fg=#0087ff,bg=#0087ff'        # Inactive pane border (bright blue)
set -g pane-border-lines heavy                          # Use heavy/thick border lines

# Copy mode visual indicators
# set -g mode-style 'bg=#ffff00,fg=#000000,bold'          # Bright yellow background with black text for selections
set -g message-style 'bg=#ff00ff,fg=#ffffff,bold'       # Magenta background for copy mode messages
setw -g mode-style 'bg=#ffff00,fg=#000000,bold'         # Ensure window mode style also set

# CRITICAL: Full-width copy mode indicator - MUST be after Catppuccin loads to override it
# This makes the ENTIRE status bar turn bright yellow when in copy mode
set -g status-style '#{?pane_in_mode,bg=#ffff00 fg=#000000 bold,bg=default fg=default}'

# vim-tmux-navigator no-wrap bindings (MUST be after plugin loads to override)
# These prevent Ctrl+hjkl from wrapping around to opposite edge
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n C-h if-shell "$is_vim" "send-keys C-h" "if-shell -F '#{pane_at_left}' '' 'select-pane -L'"
bind-key -n C-j if-shell "$is_vim" "send-keys C-j" "if-shell -F '#{pane_at_bottom}' '' 'select-pane -D'"
bind-key -n C-k if-shell "$is_vim" "send-keys C-k" "if-shell -F '#{pane_at_top}' '' 'select-pane -U'"
bind-key -n C-l if-shell "$is_vim" "send-keys C-l" "if-shell -F '#{pane_at_right}' '' 'select-pane -R'"

# Copy mode bindings (MUST be after tmux-yank loads to override plugin defaults)
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'pbcopy'
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel 'pbcopy'





